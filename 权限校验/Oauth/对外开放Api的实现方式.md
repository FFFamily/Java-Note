# 场景

需要对外开放一些系统的API，在用户申请到对应的ApiKey之后，可以通过Api文档找到对应的Api，同时在请求头中携带ApiKey，这样就能绕过校验，直接使用系统的部分功能



# 难点

1，ApiKey的生成方式，其中包括什么信息，需要包含什么信息，如何加密？

2，如何做到放行？

3，用户信息如何识别？

4，如何在不影响原代码的情况下，放行API？



# 处理逻辑

1，考虑将用户信息封装，然后生成为ApiKey，在网关拦截，解析账号密码，模拟登录获取token，再放到请求头中走正常流程

问题：拿不到密码

2，通过oauth的不同认证方式，将ApiKey视为一种用户校验信息，使得其能访问系统接口

问题：不同认证方式，生成的token不同，拿到的信息也不同

3，Aop拦截做特殊处理

问题：获取不到用户的信息



现在考虑的一点就是

重写之前的代码，改一下获取用户的方式

可以将那种直接获取用户信息的方式，改为用工具类，工具类中做判断处理

并且使用Aop，拦截判断是否携带ApiKey，然后打一个标识符，这样就方便工具类中获取用户信息