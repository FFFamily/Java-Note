# 秒杀项目日志记录

开发第一步

## 数据库设计

登录注册

```mysql
create table ums_member
(
   id                   bigint not null auto_increment comment '用户编号',
   username             char(64) comment '用户名',
   password             varchar(64) comment '密码',
   mobile               varchar(20) comment '手机号码',
   email                varchar(64) comment '邮箱',
   status               tinyint comment '状态',
   primary key (id)
);
alter table ums_member comment '会员';
```

商品信息

```mysql
create table pms_sku
(
   sku_id               bigint not null auto_increment comment '商品ID',
   sku_name             varchar(255) comment '商品名称',
   sku_desc             varchar(2000) comment '商品描述',
   sku_title            varchar(255) comment '标题',
   price                decimal(18,4) comment '价格',
   sale_count           bigint comment '销量',
   primary key (sku_id)
);
alter table pms_sku_info comment '商品信息信息';

create table ums_member_receive_address
(
   id                   bigint not null auto_increment comment 'id',
   member_id            bigint comment 'member_id',
   name                 varchar(255) comment '收货人姓名',
   phone                varchar(64) comment '电话',
   detail_address       varchar(255) comment '地址',
   primary key (id)
);
alter table ums_member_receive_address comment '会员收货地址';
```



秒杀商品

```mysql
create table seckill
(
   id                   bigint not null auto_increment comment 'id',
   title                varchar(255) comment '活动标题',
   start_time           datetime comment '开始日期',
   end_time             datetime comment '结束日期',
   create_time          datetime comment '创建时间',
   primary key (id)
);
alter table seckill comment '秒杀活动';

create table seckill_product
(
   id                   bigint not null auto_increment comment 'id',
   seckill_id           bigint comment '活动id',
   sku_id               bigint comment '商品id',
   seckill_price        decimal comment '秒杀价格',
   seckill_count        decimal comment '秒杀总量',
   seckill_limit        decimal comment '每人限购数量',
   primary key (id)
);

alter table seckill_product comment '秒杀活动商品关联';
```

> 在设计秒杀活动时想，库存的同步是在什么时候进行



仓库

```mysql
create table wms_ware_info
(
   id                   bigint not null auto_increment comment 'id',
   name                 varchar(255) comment '仓库名',
   address              varchar(255) comment '仓库地址',
   primary key (id)
);
alter table wms_ware_info comment '仓库信息';

create table wms_ware_sku
(
   id                   bigint not null auto_increment comment 'id',
   sku_id               bigint comment '商品id',
   ware_id              bigint comment '仓库id',
   stock                int comment '库存数',
   sku_name             varchar(200) comment '商品名称',
   primary key (id)
);
alter table wms_ware_sku comment '商品库存';
```

订单

```

```





## 首先是基础的CRUD开发



遇到了异常，JSON无法识别的异常，就是没有使用好驼峰命名，导致没用



处理时间问题出现问题

1，时间转换问题

```json
"endTime":"2020-05-08 17:08:10"
```

后端接收需要转换

```properties
spring:
    jackson:
        #  格式化返回时间 yyyy-MM-dd HH:mm:ss
        date-format: yyyy-MM-dd HH:mm:ss
        time-zone: GMT+8
```

或者在实体类上

```java
@DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")
private Date startTime;
```

同时mybaits的主键ID问题

```java
@TableId(type = IdType.AUTO)
private Long Id;
```

要记得加上，不然数会很大





### 库存模块

想到一个问题，怎么去修改库存，购买之后怎么去修改

> 暂时 的方案是，购买后，传入商品id以及数量，从库存中减去

没有去考虑退货问题

> 这里也衍生想了一下，如果秒杀情况下，出现了退货情况怎么考虑？



### 订单模块

涉及到了两个表，对于其添加操作需要操作2个表，这里需要注意事务问题，那么也就是分布式事务问题





## 项目中的思考

1，对于ID的处理

我接收ID，都是用String类型接收的，每次都会有一个Integer的转换，如果表大了之后就会超出Integer的范围，怎么处理这样的问题？
