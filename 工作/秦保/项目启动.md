## **脚本启动流程**

去 `/toolchain/script` 目录 执行 `./build_and_start.sh` 脚本，选择对应的微服务进行运行

## **Node 项目部署启动**

现在的分支：`shopping_mall` ,所以需要我将代码合并到 `shopping_mall` 分支，在推送代码到测试环境，然后在测试环境直接跑（因为是Node项目）

提交代码时（commit），会进行代码校验，需要解决报错问题之后才能进行提交操作

进入到对应环境后，按 `J` 选择项目

```
j
```

进入项目中选择对应的项目文件，比如说我现在的`mobile_management_backend`

```
cd mobile_management_backend
```

如果已经提交了代码，这个时候需要拉取代码

```
git pull
```

当然，如果使用了 `插件微调` ，那么就会有依赖冲突，需要解决，解决的办法就是将 `插件微调` 上传的文件给回滚

服务中提供了这样的脚本

```
gco
```

输入之后，就会看到版本不一致的文件，然后执行脚本，将所有的 文件 回滚

```
gco .
```

这个时候再进行 `pull` 操作，还是有报错的话，证明有新添加的文件，需要将其 `rm -f`

使用项目管理工具，查看已经在跑的服务

```shell
pm2 list
```

选择需要重启的服务，可以选择  编号|名称

```
pm2 restart 2 | pm2 restart xxx
```

## **分支管理**

`tutu_finance` 和 `shopping_mall` 分支都是从 `master` 分支切出来的，但是前者切的更迟所以会导致在这两者切换分支时会带入额外的“差异内容”，只需要回滚然后正常切分支

## **插件微调使用**

简单改变代码后无需进行分支提交操作，只需要使用插件进行测试

选择对应的环境

![image-20230417174214191](https://tutu-learn.oss-cn-hangzhou.aliyuncs.com/image-20230417174214191.png)

然后 进行 CPR 操作 ，也就是右上角，这个时候就会提示提交到了哪里

这个操作就是 

1，拷贝这个文件到 云端，以此模拟了 `commit` 和 `push` 操作。

## 日志查看

- 如果是走的 本地 Idea 启动，那么日志会输出在 logs 目录中
- 如果走的是 pm2 启动，那么日志就会输出在 dist 目录中，这个时候 日志输出的脚本不会生效（tracelog.sh），需要挂载一个软链才能正常输出



## Gamma 环境配置启动

### node

此时的 alph2 环境跑的分支是：tutu_finnace

gamma 环境跑的分支是：gamma

所以需要 提交代码合并到 gamma 环境（此时是需要解决某些分支问题和core那边的版本问题）

gamma环境的地址为：10.10.5.3

在该环境中更新代码

然后需要使用 发布机 去发布到 gamma 环境

发布机的地址为：10.10.2.52

进入到 `/deploy/backend`

执行脚本命令

```
 ./deploy.sh mobile_management_backend gamma
```

注意不要发布到其他的环境

### JAVA

alph2 临时环境跑的分支是：master

gamma 环境跑的分支是：gamma

gamma环境的地址为：10.10.5.3，对应的文件目录是：mobile_management_backend_java

在执行其中的脚本就能启动项目：./toolchain/script/build_and_start.sh gamma

若要执行脚本，那么只能通过挂载 ssh 的方式本地执行脚本

```
ssh -L 0.0.0.0:3306:mysql-master:3306 -N test@10.10.5.3
```

